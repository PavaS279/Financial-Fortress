{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile information and preferences.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "phone": {
          "type": "string",
          "description": "The user's phone number for alerts."
        },
        "preferences": {
          "type": "object",
          "properties": {
            "language": { "type": "string", "default": "en" },
            "theme": { "type": "string", "enum": ["light", "dark", "system"], "default": "system" },
            "alerts": {
              "type": "object",
              "properties": {
                "email": { "type": "boolean", "default": true },
                "sms": { "type": "boolean", "default": false },
                "frequency": { "type": "string", "enum": ["real-time", "daily", "weekly"], "default": "real-time" }
              }
            }
          }
        }
      },
      "required": ["name", "email"]
    },
    "Analysis": {
      "title": "Financial Analysis",
      "description": "Stores the result of a single financial analysis (UPI, Loan, or Insurance).",
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID of the user who performed the analysis."
        },
        "type": {
          "type": "string",
          "enum": ["UPI Scam", "Loan Analysis", "Insurance Decode"]
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "input": {
          "type": "object",
          "description": "The original input data for the analysis."
        },
        "result": {
          "type": "object",
          "description": "The JSON output from the AI analysis."
        },
        "riskScore": {
          "type": "number",
          "description": "A normalized risk score from 0 to 10."
        },
        "isStarred": {
          "type": "boolean",
          "default": false
        },
        "notes": {
            "type": "string",
            "description": "User-added notes for this analysis."
        }
      },
      "required": ["userId", "type", "timestamp", "input", "result"]
    },
    "Transaction": {
      "title": "Financial Transaction",
      "description": "Represents a single financial transaction being monitored.",
      "type": "object",
      "properties": {
        "userId": { "type": "string" },
        "timestamp": { "type": "string", "format": "date-time" },
        "amount": { "type": "number" },
        "recipient": { "type": "string" },
        "description": { "type": "string" },
        "status": { "type": "string", "enum": ["Verified", "Needs Review", "Recurring", "Flagged"] },
        "userFeedback": { "type": "string", "enum": ["safe", "suspicious"] }
      },
       "required": ["userId", "timestamp", "amount", "recipient", "status"]
    },
    "ScamReport": {
        "title": "Community Scam Report",
        "description": "An anonymized scam report submitted by a user.",
        "type": "object",
        "properties": {
            "region": { "type": "string" },
            "type": { "type": "string" },
            "story": { "type": "string" },
            "timestamp": { "type": "string", "format": "date-time" },
            "upvotes": { "type": "number", "default": 0 }
        },
        "required": ["region", "type", "story", "timestamp"]
    }
  },
  "auth": {
    "providers": ["anonymous"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Stores user profile and application preferences."
    },
    "/analyses/{analysisId}": {
      "schema": { "$ref": "#/entities/Analysis" },
      "description": "Stores all financial analysis reports generated by users. A top-level collection allows for easier admin queries across all users."
    },
    "/transactions/{transactionId}": {
        "schema": { "$ref": "#/entities/Transaction" },
        "description": "A log of all monitored transactions for all users."
    },
    "/communityScams/{scamId}": {
        "schema": { "$ref": "#/entities/ScamReport" },
        "description": "A collection of anonymized scam reports submitted by the community."
    }
  }
}
